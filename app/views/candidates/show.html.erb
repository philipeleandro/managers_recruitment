<main class="w-full mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mb-8 flex items-center justify-between">
    <div>
      <h1 class="text-4xl font-bold text-slate-900"><%= @candidate.name %></h1>
      <p class="mt-2 text-slate-600">Detalhes e informações do candidato</p>
    </div>
    <div class="flex gap-2">
      <%= link_to "Voltar", candidates_path, class: "rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700" %>
    </div>
  </div>

  <!-- Content -->
  <div class="grid grid-cols-1 gap-6 lg:grid-cols-3">
    <!-- Main Info -->
    <div class="lg:col-span-2">
      <div class="rounded-lg border border-slate-200 bg-white p-6">
        <div class="flex flex-row justify-between items-start">
          <h2 class="text-lg font-semibold text-slate-900 mb-4">Informações pessoais</h2>
          <% status_colors = {
            'new' => 'bg-yellow-100 text-yellow-700',
            'active' => 'bg-green-100 text-green-700',
            'inactive' => 'bg-red-100 text-red-700'
          } %>
          <span class="inline-flex w-[60px] items-center justify-center rounded-lg px-3 py-1 text-xs <%= status_colors[@candidate.status] %>">
            <%= @candidate.status_humanize %>
          </span>
        </div>
        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
          <div>
            <label class="text-sm font-medium text-slate-600">CPF</label>
            <p class="mt-2 text-slate-900"><%= @candidate.cpf %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-slate-600">E-mail</label>
            <p class="mt-2 text-slate-900">
              <%= @candidate.email %>
            </p>
          </div>
          <div>
            <label class="text-sm font-medium text-slate-600">Telefone</label>
            <p class="mt-2 text-slate-900"><%= @candidate.phone_number %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-slate-600">Currículo</label>
            <p class="mt-2 text-slate-900">
              <% if @candidate.resume.attached? && @candidate.resume.persisted? %>
                <%= link_to @candidate.resume.filename, rails_blob_path(@candidate.resume), target: "_blank", class: "text-sm text-blue-600 hover:text-blue-700" %>
              <% else %>
                <span class="text-sm text-slate-400">Sem currículo</span>
              <% end %>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="flex flex-col h-full">
      <div class="flex-1 rounded-lg border border-slate-200 bg-white p-6">
        <h3 class="font-semibold text-slate-900 mb-4">Ações</h3>
        <div class="space-y-2">
          <%= link_to "Atrelar a vaga", candidate_path(@candidate), class: "block rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-900 text-center hover:bg-slate-50" %>
          <%= link_to "Editar Candidato", edit_candidate_path(@candidate), class: "block rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-900 text-center hover:bg-slate-50" %>
          <%= link_to "Excluir", candidate_path(@candidate), data: { turbo_method: :delete, turbo_confirm: "Tem certeza que deseja excluir?",turbo_frame: "_top" }, class: "block rounded-lg border border-red-200 px-4 py-2 text-sm font-medium text-red-600 text-center hover:bg-red-50" %>
        </div>
      </div>
    </div>
  </div>

  <!-- application -->
  <div class="mt-8">
    <% if @applications.any? %>
      <div class="overflow-x-auto rounded-xl border border-slate-200 bg-white shadow-sm">
        <table class="w-full">
          <div class="px-6 py-4 border-b border-slate-200">
            <h2 class="text-lg font-semibold text-slate-900">Lista de Aplicações</h2>
            <p class="text-sm text-slate-600 mt-1">Mostrando <%= @applications.count %> de <%= 200 %> Aplicações</p>
          </div>
          <thead class="border-b border-slate-200">
            <tr>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">Nome</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">E-mail</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">CPF</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">Telefone</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">Status</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">Currículo</th>
              <th class="px-6 py-4 text-center text-sm font-semibold text-slate-900">Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @applications.each do |application| %>
              <tr class="text-center border-b border-slate-200 hover:bg-slate-50 transition-colors">
                <td class="px-6 py-4">
                  <p class="text-left font-medium text-slate-900"><%= application.name %></p>
                </td>
                <td class="px-6 py-4">
                  <p class="text-left text-sm text-slate-600"><%= application.email %></p>
                </td>
                <td class="px-6 py-4">
                  <p class="text-left text-sm text-slate-600"><%= application.cpf %></p>
                </td>
                <td class="px-6 py-4">
                  <p class="text-left text-sm text-slate-600"><%= application.phone_number %></p>
                </td>
                <td class="px-6 py-4 text-center">

                <!-- COLOCAR EM HELPER TO -->

                </td>
                <td class="px-6 py-4">
                  <% if application.resume.present? %>
                    <%= link_to "Visualizar", rails_blob_path(application.resume), target: "_blank", class: "text-sm font-medium text-blue-600 hover:text-blue-700" %>
                  <% else %>
                    <span class="text-sm text-slate-400">Sem curriculo</span>
                  <% end %>
                </td>
                <td class="px-6 py-4 text-right">
                  <div class="flex gap-2 justify-center">
                    <%= link_to inline_svg_tag('icons/pencil.svg', class: "lucide lucide-pen h-4 w-4 text-blue-600"),
                          edit_application_path(application),
                          class: "text-sm font-medium text-blue-600 hover:text-blue-700",
                          data: { turbo_frame: "candidate_management", action: "click->candidates-form#forceOpen" } %>

                    <%= link_to inline_svg_tag('icons/trash_can.svg', class: "lucide lucide-trash2 h-4 w-4 text-red-600"),
                        candidate_path(candidate),
                        data: { turbo_method: :delete, turbo_confirm: "Tem certeza que deseja excluir?" },
                        class: "text-sm font-medium text-red-600 hover:text-red-700",
                        id: 'delete-candidate-button' %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <%= paginate @applications, window: 5, outer_window: 1 %>
      </div>
    <% else %>
      <div class="rounded-xl border border-slate-200 bg-white px-6 py-4 shadow-sm">
        <h2 class="text-lg font-semibold text-slate-900">Lista de Aplicações</h2>
        <p class="text-sm text-slate-600 mt-1">Mostrando <%= @applications.count %> aplicações</p>

        <div class="p-12 text-center">
          <p class="text-slate-600">Nenhuma aplicação encontrada</p>
        </div>
      </div>
    <% end %>
  </div>
</main>
